
该模块的总体可大致分为:输入模块，交换模块和输出模块三各部分。其中输入模块负责数据包解析，校验数据生成。交换模块为该模块的核心部分，负责数据的转发分类，中sram的的存储控制也由该模块实现。输出模块负责数据的调度管理以及校验。

### **voq**
为了实现内存回收以及多端口之间的动态存储。我们采用虚拟输出队列的方式来对单片sram进行管理，将没块sram按照端口数划分为16块区域，并每个区域的读写遵循先进先出的方式  
#### 端口和功能介绍

voq的各个输入端口和输出端口如下

- 写入控制端口
    - ` wr_data ` ：待写入的数据。
    - ` wr_sel ` ：选择写入的队列。
    - ` wr_vaild `：写入有效端，当信号有效时，在时钟上升沿将`wr_data`的数据写入`wr_sel`选择的队列中。
- 写入控制端口
    - ` rd_data ` ：读出的数据数据输出。
    - ` rd_sel ` ：选择读出的队列。
    - ` rd_vaild `：读出有效端，当信号有效时，在时钟上升沿将输出指定队列的数据。
- 其他端口
    - `full` ：满信号，当voq的存储空间写满时，该信号输出1
    - `alm_ost_full` ：当存储空间低于设定阈值时，该信号输出1
    - `empty`: 空信号，共16个代表16个队列，当第N个队列空时，第N位输出高1
    - `space`: 输出voq的有效存储空间

从使用上看，如图所示，`wr_sel`和`rd_sel`分别为数据分配器和数据选择器的选择端。从多个队列中选择单个，并且这些队列的存储都在一块sram上并且每个队列之间的存储空间是动态共享的。因此该模块只有一个full信号，而有多个empty信号。
![voq](/home/dv/verilog/switching_unit/draw/voq.png)

我们采用虚拟虚拟队列(voq)的方式来管理单片sram，将每块ram划分为16(端口数)块储存区域并且每个存储区域之间动态分配,且每个存储区域遵循先入先出的读
写方式。根据存储数据的接收端口来对每个区域进行划分。现在单片sram是动态共享,如果每块sram之间数据的存放是均匀的，那么也就实现了n块sram之间的动
态共享存储。使用对各个端口发送进来的数据进行旋转移位的方式来使数据均匀地存放到每个voq中。目前已经对数据的接受队列来进行分类存储，下一步根据数
据帧的发送端口来进行分类存放到下一级voq中。最后通过调度模块对数据进行调度。

